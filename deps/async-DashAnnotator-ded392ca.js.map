{"version":3,"file":"async-DashAnnotator-ded392ca.js","mappings":"ypEAOqBA,EAAAA,SAAAA,I,8cACH,CACVC,IAAKC,EAAAA,QACLC,KAAMC,EAAAA,QACNC,KAAMC,EAAAA,U,qCAGV,WACIC,QAAQC,IAAI,OAAQC,MACpB,MAA0CA,KAAKC,MAA5BC,EAAnB,EAAQC,UAAwBF,EAAhC,OACMG,EAAYJ,KAAKK,YAAYH,GAEnC,QAAkBI,IAAdF,EACA,MAAM,IAAIG,MAAM,4DAGpB,OAAO,kBAACH,EAAcH,EACzB,M,gFAjBgBV,CAAsBiB,EAAAA,WAqB3CjB,EAAckB,aAAeA,EAAAA,GAC7BlB,EAAcmB,UAAYA,EAAAA,E,u0GCxB1B,IAuBMC,EAAAA,SAAAA,G,iHACF,SAAgBC,EAAhB,GAA+C,IAAvBC,EAAuB,EAAvBA,MAASC,EAAc,wDACvCC,EAAS,CACTC,SAAU,WACVC,OAAQL,EAAKK,OAAS,EACtBC,IAAKN,EAAKM,IAAMlB,KAAKC,MAAMkB,eAAeC,QAC1CC,KAAMT,EAAKS,KAAOrB,KAAKC,MAAMkB,eAAeG,QAC5CC,MAAOX,EAAKW,MACZC,UAAW,iBACXC,gBAAiB,OACjBC,QAAS,GAWb,OARIZ,IACAC,EAAS,EAAH,KACCA,GADD,IAEFU,gBAAiBZ,GAASb,KAAKC,MAAMY,OAAS,SAC9Cc,QAAS,KAIVZ,CACV,G,oBAED,WAAS,WAkBP,OAAO,+BAhBE,EAAKd,MAAM2B,WAAWC,KAAI,SAAAC,GAC/B,OAAOA,EAAiBd,SAASa,KAAI,SAACE,EAAWC,GAC/C,OACE,2BAAKC,IAAKD,GACR,2BACIE,MAAO,EAAKC,gBAAgBJ,EAAWD,GACvCM,QAAS,kBAAM,EAAKnC,MAAMmC,QAAQN,EAAzB,EACTO,YAAa,kBAAM,EAAKpC,MAAMoC,YAAYP,EAA7B,IAEjB,2BAAKI,MAAO,EAAKC,gBAAgBJ,EAAWD,GAAkB,KAGnE,GACF,IAIJ,K,EA3CCnB,CAAmBH,EAAAA,WA8CJb,EAAAA,SAAAA,G,kBACjB,WAAYM,GAAO,2BACf,cAAMA,IADS,QAKX,CACJqC,0BAA0B,EAC1BC,UAAW,KACXpB,eAAgB,CACZC,QAAS,EACTE,QAAS,KARb,EAAKkB,WAAYC,EAAAA,EAAAA,aAFF,CAGlB,C,2CAWD,WACIzC,KAAK0C,2BACR,G,kCAED,WACI1C,KAAK0C,2BACR,G,uCAED,WAA4B,QACxB,UAAI1C,KAAKwC,iBAAT,iBAAI,EAAgBG,eAApB,OAAI,EAAyBC,kBACzB5C,KAAKwC,UAAUG,QAAQC,gBAAgBC,oBACnC,SAAU7C,KAAK8C,SAASC,KAAK/C,OACjCA,KAAKwC,UAAUG,QAAQC,gBAAgBC,oBACnC,UAAW7C,KAAKgD,UAAUD,KAAK/C,OAE1C,G,oCAED,WAAyB,QACrB,UAAIA,KAAKwC,iBAAT,iBAAI,EAAgBG,eAApB,OAAI,EAAyBC,kBACzB5C,KAAKwC,UAAUG,QAAQC,gBAAgBK,iBACnC,SAAUjD,KAAK8C,SAASC,KAAK/C,OACjCA,KAAKwC,UAAUG,QAAQC,gBAAgBK,iBACnC,UAAWjD,KAAKgD,UAAUD,KAAK/C,OAExC,G,sBAEH,WACIA,KAAKkD,SAAS,CACV/B,eAAgB,CACZC,QAASpB,KAAKwC,UAAUG,QAAQQ,cAAc/B,QAC9CE,QAAStB,KAAKwC,UAAUG,QAAQQ,cAAc7B,UAGzD,G,uBAED,WACI,IAAMiB,EAAYvC,KAAKwC,UAAUG,QAAQQ,cAAcC,eACjDxD,EAAO2C,EAAUc,WACvB,GAAIzD,EAAM,CACN,IACMoB,EAnHe,SAC/BsC,EACAnC,GAEA,OAAOoC,MAAMC,KAAKF,GAAsBzB,KAAI,SAAA4B,GAC1C,MAAO,CACLpC,KAAMoC,EAAKpC,KAAOF,EAAeG,QACjCJ,IAAKuC,EAAKvC,IAAMC,EAAeC,QAC/BH,OAAQwC,EAAKxC,OACbM,MAAOkC,EAAKlC,MAEf,GACF,CAuG4BmC,CADYnB,EAAUoB,WAAW,GAAGC,iBAGjD5D,KAAK6D,MAAM1C,gBAEfnB,KAAKkD,SAAS,CACVX,UAAW,CAAEvB,SAAAA,EAAUpB,KAAAA,GACvB0C,0BAA0B,IAE9BtC,KAAK8D,oBAAoB9D,KAAK6D,MAAMtB,WACpCvC,KAAKC,MAAM8D,SAAS,CAChBnC,WAAY,GAAF,SACH5B,KAAKC,MAAM2B,YADR,CAEN5B,KAAK6D,MAAMtB,aAItB,CAEDvC,KAAKkD,SAAS,CAAEX,UAAW,OAC3BA,EAAUyB,OACb,G,0BAED,SAAaC,EAAMC,GAAO,MACtBlE,KAAKC,MAAM8D,SAAS,CAChBI,MAAO,CAAEF,KAAAA,EAAMC,MAAAA,EAAOE,IAAG,UAACpE,KAAKC,MAAMkE,aAAZ,OAAC,EAAkBC,KAEnD,G,iCAED,SAAoBC,GAChBrE,KAAKsE,aAAa,gBAAiBD,EACtC,G,+BAED,SAAkBA,GACdrE,KAAKsE,aAAa,oBAAqBD,EAC1C,G,+BAED,SAAkBA,GACTrE,KAAK6D,MAAMvB,yBAGZtC,KAAKkD,SAAS,CACVZ,0BAA0B,IAH9BtC,KAAKsE,aAAa,oBAAqBD,EAO9C,G,oBAED,WAAS,WACD9C,EAAQvB,KAAKC,MAAMsB,OAAS,OAC5BN,EAASjB,KAAKC,MAAMgB,QAAU,OAEpC,OACE,2BACEsD,aAAc,kBAAM,EAAKrB,SAAS,CAAEX,UAAW,MAAjC,EACdL,MAAO,CACLsC,SAAU,SACVxD,SAAU,WACVO,MAAAA,EACAN,OAAAA,IAGF,8BACEwD,OAAQzE,KAAKC,MAAMyE,KACnBnD,MAAOA,EACPN,OAAQA,EACR0D,IAAK3E,KAAKwC,UACVoC,OAAQ5E,KAAK6E,uBAAuB9B,KAAK/C,UAExCA,KAAKC,MAAM2B,YACZ,oBAACjB,EAAD,CACEiB,WAAY5B,KAAKC,MAAM2B,WACvBf,MAAOb,KAAKC,MAAMY,MAClBM,eAAgBnB,KAAK6D,MAAM1C,eAC3BiB,QAASpC,KAAK8E,kBAAkB/B,KAAK/C,MACrCqC,YAAarC,KAAK+E,kBAAkBhC,KAAK/C,QAKlD,K,EAtIgBL,CAAsBa,EAAAA,WA0I3Cb,EAAcc,aAAeA,EAAAA,GAC7Bd,EAAce,UAAYA,EAAAA,E,mlHC3M1BsE,OAAOC,EAAIA,EAKX,IAAMC,EAAW,SAACC,EAAUC,GAC1B,IAAIC,EACJ,OAAO,WAAa,2BAATC,EAAS,yBAATA,EAAS,gBAClB,IAAMC,EAAU,EAChBC,aAAaH,GACbA,EAAUI,YAAW,kBAAMN,EAASO,MAAMH,EAASD,EAA9B,GAAqCF,EAC3D,CACF,EAqDKO,EAA6B,SAACC,EAAYC,GAAb,OACjCD,EAAW1E,KAAO2E,EAAS3E,KAC3B0E,EAAWE,QAAUD,EAASC,QAC9BF,EAAWG,OAASF,EAASE,OAC7BH,EAAWvE,MAAQwE,EAASxE,IAJK,EAM7B2E,EAAW,SAACC,EAAGC,GAAJ,OACfD,EAAEE,OAASD,EAAEC,MACbF,EAAE5E,MAAQ6E,EAAE7E,MACZ6E,EAAE7E,MAAQ4E,EAAE5E,KAAO4E,EAAE1E,KAHN,EAKX6E,EAAW,SAACH,EAAGC,GAAJ,IAAOG,EAAP,uDAAiB,EAAjB,OACfJ,EAAEE,OAASD,EAAEC,MACbG,KAAKC,IAAIN,EAAE/E,IAAMgF,EAAEhF,KAAOmF,GAC1BC,KAAKC,IAAIN,EAAEhF,OAASiF,EAAEjF,QAAUoF,CAHjB,EAYXG,EAAS,SAACP,EAAGC,GAAoB,IAAjBO,EAAiB,uDAAP,GACxBC,EAAST,EAAE5E,KAAO4E,EAAE1E,MACpBoF,EAAST,EAAE7E,KAAO6E,EAAE3E,MAE1B,OACE0E,EAAEE,OAASD,EAAEC,MACbF,EAAE5E,MAAQ6E,EAAE7E,MACZqF,GAAUC,GACVT,EAAE7E,KAAOqF,GAAUD,CAEtB,EAEKG,EAAc,SAACX,EAAGC,GACtBD,EAAE1E,MAAQ+E,KAAKO,IAAIX,EAAE3E,MAAQ0E,EAAE5E,KAAO6E,EAAE7E,KAAM4E,EAAE1E,MACjD,EAEKuF,EAAsB,SAAAC,GAgB1B,IAfA,IAAMC,EAAQD,EAAYE,MAAK,SAAChB,EAAGC,GACjC,IAAMhF,GAAO+E,EAAEE,MAAQ,GAAKF,EAAE/E,KAAOgF,EAAEC,MAAQ,GAAKD,EAAEhF,IACtD,OAAe,IAARA,EAAY+E,EAAE5E,KAAO6E,EAAE7E,KAAOH,CACtC,IAEKgG,EAAW,IAAIC,IAEfC,EAAYJ,EAAMK,QAAO,SAAAzG,GAC7B,OAAOoG,EAAMM,OAAM,SAAAC,GACjB,OAjCarB,EAiCQqB,KAjCXtB,EAiCKrF,GAhCjBuF,OAASD,EAAEC,MACbF,EAAE/E,IAAMgF,EAAEhF,KACV+E,EAAE5E,KAAO6E,EAAE7E,MACX4E,EAAE/E,IAAM+E,EAAEhF,OAASiF,EAAEhF,IAAMgF,EAAEjF,QAC7BgF,EAAE5E,KAAO4E,EAAE1E,MAAQ2E,EAAE7E,KAAO6E,EAAE3E,OALjB,IAAC0E,EAAGC,CAkCd,GACF,IAEGsB,EAAY,EAETA,GAAa,GAClBJ,EAAUK,SAAQ,SAAAxB,GAChBmB,EAAUK,SAAQ,SAAAvB,GACZD,IAAMC,GAAKgB,EAASQ,IAAIzB,IAAMiB,EAASQ,IAAIxB,IAI1CE,EAASH,EAAGC,KAIbF,EAASC,EAAGC,KACdU,EAAYX,EAAGC,GACfD,EAAEhF,OAASqF,KAAKO,IAAIZ,EAAEhF,OAAQiF,EAAEjF,QAEhCiG,EAASS,IAAIzB,IAGXM,EAAOP,EAAGC,KACZU,EAAYX,EAAGC,GAEfgB,EAASS,IAAIzB,IAEhB,GACF,IACDsB,GAAa,EAGf,OAAOJ,EAAUC,QAAO,SAAAzG,GAAI,OAAKsG,EAASQ,IAAI9G,EAAlB,GAC7B,EAoCKgH,EAAc,SAAAC,GAAC,OAAKA,GAAK,CAAC,GAAGC,eAAiBC,QAA/B,EACfC,EAAY,SAAAH,GAAC,OAAKD,EAAYC,IAAM,CAAC,GAAGI,aAAejD,MAA1C,EACbkD,EAAgB,SAAAL,GAAC,OACrBA,aAAaM,aAAeN,aAAaG,EAAUH,GAAGM,WADjC,EAGjBC,EAAqB,SAAAC,GACzB,IAAMC,EAAOD,EAAOE,QAAQ,SAE5B,OAAKD,GAASJ,EAAcI,GAMrB,CAAEA,KAAAA,EAAME,OAFAC,OAAOH,EAAKI,QAAQC,aAH1B,IAMV,EA2CoBC,EAAAA,SAAAA,I,4SAoBnB,WAAY3I,GAAO,a,4FAAA,aACjB,cAAMA,IADW,QAfX,CACN4I,aAAa,EACbC,MAAO,OAaU,kBAVR,IAAIC,EAAAA,UAUI,qBATL,IAAIC,EAAAA,eAAe,CAC/BC,SAAU,EAAKA,SACfC,mBAAoB,KAOH,wBAJF,MAIE,uBAHH,MAGG,sBAFL,WAAQ,IAEH,oBAWP,SAAAvE,GACV,WAAQsE,EAAR,EAAQA,SAA0BE,EAAlC,EAAkBC,eAIlB,GAHA,EAAKC,cAAgB1E,EACrB,EAAK2E,cAED3E,EAAK,OACgB4E,EAAQ5E,EAAvBmD,cACRmB,EAASO,GAAG,oBAAqB,EAAKC,qBACtCR,EAASO,GAAG,YAAa,EAAKE,iBAC9BH,EAAItG,iBAAiB,kBAAmB,EAAK0G,mBAC7CJ,EAAItG,iBAAiB,UAAW,EAAK2G,eACrC,UAAAL,EAAItB,mBAAJ,SAAiBhF,iBAAiB,SAAU,EAAK4G,qBAC7CV,GAAUA,EAASW,QAAQnF,GAE/B,EAAK2E,YAAc,WAAM,MACvBL,EAASc,IAAI,YAAa,EAAKL,iBAC/BT,EAASc,IAAI,oBAAqB,EAAKN,qBACvCF,EAAI1G,oBAAoB,kBAAmB,EAAK8G,mBAChDJ,EAAI1G,oBAAoB,UAAW,EAAK+G,eACxC,UAAAL,EAAItB,mBAAJ,SAAiBpF,oBAAoB,SAAU,EAAKgH,qBAChDV,GAAUA,EAASa,YACxB,CACF,CACF,IAlCkB,8BAqIG,WACpB,EAAKC,kBACN,IAvIkB,0BAyID,WAChB,EAAKC,kBACN,IA3IkB,4BA6IC,WAClB,IAAMC,EAAY,EAAKd,cACjB9G,EAAYyF,EAAUmC,GAAW/G,eAEvC,GAAKb,EAAL,CAIA,IAAMuG,EAAQvG,EAAU6H,WAAa,EAAI7H,EAAUoB,WAAW,GAAK,KAE/DpB,EAAUsG,YACZ,EAAK3F,SAAS,CAAE2F,aAAa,IAK5BC,GACAqB,GACAA,EAAUE,SAASvB,EAAMwB,2BAK5B,EAAKpH,SAAS,CACZ2F,aAAa,EACbC,MAAAA,IAGF,EAAKyB,0BAtBJ,CAuBF,IA1KkB,mBA4KR,WACT,EAAKN,mBAEL,EAAKO,OAAOL,UAAUtH,oBAAoB,SAAU,EAAKC,SAC1D,IAhLkB,sBAkLL,SAAAqB,GACP+D,EAAc/D,EAAMkE,OAG1B,IAtLkB,yBAwLF,WACf,MAA+B,EAAKxE,MAA5BgF,EAAR,EAAQA,YAAaC,EAArB,EAAqBA,MACf2B,EAvPgB,SAAA3B,GAAS,QAC3B4B,EAAqB5B,SAAH,UAAGA,EAAO6B,sBAAV,aAAG,EAAuBC,cAC5CC,EAAmB/B,SAAH,UAAGA,EAAOgC,oBAAV,aAAG,EAAqBF,cAE9C,IAAK1C,EAAcwC,KAAwBxC,EAAc2C,GACvD,MAAO,GAGT,IAAME,EAAY3C,EAAmBsC,GAC/BM,EAAU5C,EAAmByC,GAEnC,GAAKE,UAAAA,EAAWvC,QAAWwC,UAAAA,EAASxC,OAClC,MAAO,GAGT,GAAIuC,EAAUvC,SAAWwC,EAAQxC,OAC/B,MAAO,CAACuC,GAGV,GAAIA,EAAUvC,SAAWwC,EAAQxC,OAAS,EACxC,MAAO,CAACuC,EAAWC,GASrB,IANA,IAAMP,EAAQ,GAEVQ,EAAcF,EAAUvC,OAEtBT,EAAWgD,EAAUzC,KAAKR,cAEzBmD,GAAeD,EAAQxC,QAAQ,CACpC,IAAMyC,EAAc7C,EAClBL,EAASmD,cAAT,6BAA6CD,EAA7C,OAEEA,GACFR,EAAMU,KAAKF,EAEd,CAED,OAAOR,CACR,CAgNiBW,CAAkBtC,GAC1B9B,EA3Sa,SAAC8B,EAAO2B,GAK7B,IAL8D,IAA1BY,IAA0B,yDACxDtE,EAAcxD,MAAMC,KAAKsF,EAAMlF,kBAE/BoD,EAAQ,GAEd,MAAyBD,EAAzB,eAAsC,CAAjC,IAAiC,EAA3BnB,EAAU,KAAiB,IACjB6E,GADiB,IACpC,IAAK,EAAL,qBAA0B,KAAftE,EAAe,QAClBN,EAAWM,EAAKmC,KAAKgD,wBAE3B,GACE3F,EAA2BC,EAAYC,IACvCD,EAAW1E,KAAO,GAClB0E,EAAWE,QAAU,GACrBF,EAAWrE,MAAQ,GACnBqE,EAAW3E,OAAS,GACpB2E,EAAWrE,MAAQsE,EAAStE,OAC5BqE,EAAW3E,OAAS4E,EAAS5E,OAC7B,CACA,IAAMsK,EAAkB,CACtBrK,IAAK0E,EAAW1E,IAAMiF,EAAKmC,KAAKkD,UAAY3F,EAAS3E,IACrDG,KAAMuE,EAAWvE,KAAO8E,EAAKmC,KAAKmD,WAAa5F,EAASxE,KACxDE,MAAOqE,EAAWrE,MAClBN,OAAQ2E,EAAW3E,OACnBkF,KAAMA,EAAKqC,QAGbxB,EAAMmE,KAAKI,EACZ,CACF,CAvBmC,+BAwBrC,CAED,OAAOF,EAAiBvE,EAAoBE,GAASA,CACtD,CA2QiBpD,CAAekF,EAAO2B,GAEpC,GACG3B,IACDD,GACC4B,GACe,GAAhBA,EAAMiB,QACW,IAAjB1E,EAAM0E,OALR,CASA,IAAMC,EA/bc,SAAA5E,GACtB,IAAMC,EAAQzD,MAAMC,KAAKuD,GAAalF,KAAI,SAAAjB,GACxC,IAAQS,EAAmCT,EAAnCS,KAAMH,EAA6BN,EAA7BM,IAQd,MAAO,CAAE0K,GANEvK,EAMEwK,GALFxK,EAHgCT,EAAxBW,MAQFuK,GAHN5K,EAGU6K,GAFV7K,EANgCN,EAAjBK,OAQDkF,KARkBvF,EAATuF,KASnC,IAEG6F,EAAYvD,OAAOwD,iBAEvBjF,EAAMS,SAAQ,SAAA7G,GAAQ,MACpBoL,EAAY1F,KAAK4F,IACfF,EADU,UAEVpL,EAAKuF,YAFK,QAEG6F,EAEhB,IAED,IAAMG,EAA2BnF,EAAMK,QACrC,SAAAzG,GAAI,OACDA,EAAKgL,GAAK,GAAKhL,EAAKiL,GAAK,GAAKjL,EAAKkL,GAAK,GAAKlL,EAAKmL,GAAK,IACxDnL,EAAKuF,OAAS6F,CAFZ,IAKAI,EAAUD,EAAyBE,QAAO,SAACC,EAAK1L,GACpD,MAAO,CACLgL,GAAItF,KAAK4F,IAAII,EAAIV,GAAIhL,EAAKgL,IAC1BC,GAAIvF,KAAKO,IAAIyF,EAAIT,GAAIjL,EAAKiL,IAE1BC,GAAIxF,KAAK4F,IAAII,EAAIR,GAAIlL,EAAKkL,IAC1BC,GAAIzF,KAAKO,IAAIyF,EAAIP,GAAInL,EAAKmL,IAE1B5F,KAAM6F,EAET,GAAEG,EAAyB,IAEpBP,EAAyBQ,EAAzBR,GAAIC,EAAqBO,EAArBP,GAAIC,EAAiBM,EAAjBN,GAEhB,MAAO,CACLzK,KAAMuK,EACN1K,IAAK4K,EACLvK,MAAOsK,EAAKD,EACZ3K,OAN+BmL,EAAbL,GAMLD,EACb3F,KAP+BiG,EAATjG,KASzB,CA8YwBoG,CAAgBvF,GAErC,EAAK/G,MAAMuM,oBACT,CACErG,KAAMsE,EAAM,GAAGjC,OACfmD,aAAAA,EACA3E,MAAAA,GAEF8B,EAAMzF,WAVA,CAYT,IAhNkB,iCAkNO6B,EAAS,EAAKuH,eAAgB,MAlNrC,2BAoNA,WACb,EAAKjC,SACP,EAAKA,OAAOkC,kBAAoB,EAAKzM,MAAM0M,cAE9C,IAxNkB,6BA0NGzH,EAAS,EAAKgF,iBAAkB,MAxNtB,oBAAnB0C,iBACT,EAAKxD,eAAiB,IAAIwD,eAAe,EAAK/C,sBAH/B,CAKlB,C,8CAED,WACE7J,KAAK6M,MACN,G,gCA2BD,SAAmBC,GACbA,EAAUC,cAAgB/M,KAAKC,MAAM8M,YACvC/M,KAAK6M,OACIC,EAAUlL,aAAe5B,KAAKC,MAAM2B,YAC7C5B,KAAKiK,iBAAiBjK,KAAKC,MAE9B,G,kBAED,WACE,IAAQ8M,EAAgB/M,KAAKC,MAArB8M,YAER/M,KAAKgN,eACHhN,KAAKgN,gBACL,IAAIC,EAAAA,kBAAkB,CACpBC,YAAalN,KAAKkN,YAClBjE,SAAUjJ,KAAKiJ,WAGnBjJ,KAAKwK,OACHxK,KAAKwK,QACL,IAAI2C,EAAAA,UAAU,CACZhD,UAAWnK,KAAKqJ,cAChBJ,SAAUjJ,KAAKiJ,SACf+D,eAAgBhN,KAAKgN,eACrBI,cAAe,EACfC,mBAAmB,EACnBH,YAAalN,KAAKkN,YAClBI,SAAU,SACVC,KAAM,OAGVvN,KAAKkN,YAAYM,YAAYT,GAC7B/M,KAAKkN,YAAYO,UAAUzN,KAAKwK,QAChCxK,KAAKwK,OAAOgD,YAAYT,GAExBjN,QAAQC,IAAI,aAAcC,KAC3B,G,kCAED,WACEA,KAAKsJ,aACN,G,wCAED,SAA2BnD,GACzB,IAAQuH,GAAc1N,KAAKwK,OAAOmD,YAAYxH,EAAO,IAAM,CAAC,GAApDuH,UAER,IAAKA,EACH,OAAO,KAGT,IAAIE,EAAiBF,EAAUG,aAAa3C,cAC1C,oCASF,OANK0C,KACHA,EAAiBhG,EAAY8F,EAAUG,cAAcC,cAAc,QACpDC,UAAY,mCAC3BL,EAAUG,aAAaG,YAAYJ,IAG9BA,CACR,G,8BAED,SAAiBK,GAUf,IATA,MAA2CA,GAAajO,KAAKC,MAArDiO,EAAR,EAAQA,mBAAoBtM,EAA5B,EAA4BA,WAEpBmL,EAAgB/M,KAAKC,MAArB8M,YAEFoB,EAAmBlJ,EAAAA,QACvBA,EAAAA,KAAO,CAAC,WAAY,SACpBA,EAAAA,OAASmJ,QAASxM,IAGXuE,EAAO,EAAGA,GAAQ4G,EAAYsB,SAAUlI,IAAQ,CACvD,IAAMmI,EAAiBtO,KAAKuO,2BAA2BpI,GAEnDmI,GACFE,IAAAA,OACE,gCACIL,EAAiBM,OAAOtI,KAAU,IAAItE,KACtC,WAAiCG,GAAU,IAAxChB,EAAwC,EAAxCA,SAAU0N,EAA8B,EAA9BA,GAAOrK,EAAuB,OACzC,OAAO6J,EAAmB,EAAD,CAErBQ,GAAAA,EACA1N,SAAUA,GACPqD,GAELrC,EAEH,KAGLsM,EAGL,CACF,G,oBAyFD,WACE,OACE,2BAAKK,cAAe3O,KAAK4O,aACvB,2BACEjK,IAAK3E,KAAK6O,UACVd,UAAU,iBACVe,cAAe,SAAAjH,GAAC,OAAIA,EAAEkH,gBAAN,EAChB7M,MAAO,CACLjB,OAAQjB,KAAKC,MAAMgB,OACnBM,MAAOvB,KAAKC,MAAMsB,QAGpB,2BAAKwM,UAAU,eAItB,M,gFAhQkBnF,CAAuBoG,EAAAA,e,EAAvBpG,EAAAA,eACG,CACpB+D,cAAe,S,ooEC1PnB,IAAIsC,EAAgB,WAEpB,SAASC,EAAuBC,GAO9B,IANA,IAAIC,EAAcD,EAAQE,QAAQJ,GAAiBA,EAAcvD,OAC7D4D,EAASH,EAAQI,UAAUH,GAC3BI,EAAMxK,OAAOyK,KAAKH,GAClBI,EAAYF,EAAI9D,OAChBiE,EAAQ,IAAIC,WAAW,IAAIC,YAAYH,IAEnCI,EAAI,EAAGA,EAAIJ,EAAWI,IAC5BH,EAAMG,GAAKN,EAAIO,WAAWD,GAE5B,OAAOH,CACR,C,IAGoBK,EAAAA,SAAAA,I,wcACX,CACNjD,YAAa,KACbkD,MAAO,O,qBAOKC,IAAAA,a,gDAEd,WACElQ,KAAKmQ,MACN,G,kCAED,WACE,IAAqBC,EAAsBpQ,KAAK6D,MAAxCkJ,YACJqD,GACFA,EAAkBC,SAErB,G,gCAED,YAA6B,IAAR3L,EAAQ,EAARA,KACf1E,KAAKC,MAAMyE,OAASA,GACtB1E,KAAKmQ,MAER,G,+BAED,SAAkBF,EAAOK,GACvB,IAAQC,EAAYvQ,KAAKC,MAAjBsQ,QAEJA,GACFA,EAAQN,GAGVjQ,KAAKkD,SAAS,CAAE6J,YAAa,KAAMkD,MAAAA,GACpC,G,kBAED,WAAO,WACL,GAAqCjQ,KAAKwQ,YAAY7N,SAAW,CAAC,GAA1DmF,cAAAA,OAAR,MAAwBC,SAAxB,EACA,EAAiD/H,KAAKC,MAA9CyE,EAAR,EAAQA,KAAM+L,EAAd,EAAcA,QAASC,EAAvB,EAAuBA,WAAYC,EAAnC,EAAmCA,UACdP,EAAsBpQ,KAAK6D,MAAxCkJ,YACR/M,KAAKkD,SAAS,CAAE6J,YAAa,KAAMkD,MAAO,OAEjB,iBAAdU,IACTC,EAAAA,oBAAAA,UAAgCD,GAGlCE,QAAQC,UACLC,MAAK,kBAAMX,GAAqBA,EAAkBC,SAA7C,IACLU,MAAK,WACJ,GAAKrM,EAIL,OAAOkD,EAAAA,EAAAA,aAAY,OACd,EAAK3H,OADQ,IAEhByE,KAAMwK,EAAuBxK,GAC7BiM,UAAW,gEACX7I,cAAAA,EACA2I,QAAAA,EACAC,WAAAA,KACCM,QAAQD,MAAK,SAAAhE,GACd,EAAK7J,SAAS,CAAE6J,YAAAA,GACjB,GACF,IAjBH,OAkBS,SAAAlF,GAAC,OAAI,EAAKoJ,kBAAkBpJ,EAA3B,GACX,G,oBAED,WACE,MAAiC7H,KAAKC,MAA9BiR,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,WAClB,EAA+BnR,KAAK6D,MAA5BkJ,EAAR,EAAQA,YAAakD,EAArB,EAAqBA,MACrB,OACE,oCACE,0BAAMtL,IAAK3E,KAAKwQ,cACfP,EACGjQ,KAAKoR,cACJrE,GAAgBmE,EAEjBA,EAASnE,GADToE,EAIT,G,yBAED,WACE,IAAQE,EAAiBrR,KAAKC,MAAtBoR,aACR,OAAIA,EACKnB,IAAAA,aAAmBmB,EAAc,CAAEpB,MAAOjQ,KAAK6D,MAAMoM,QAGvD,IACR,M,gFA5FkBD,CAAkBxP,EAAAA,W,08CAAlBwP,EAAAA,eAMG,CACpBW,UAAW,kE,ICzBMW,GAAAA,SAAAA,I,uYACpB,WACC,MAIItR,KAAKC,MAHRe,EADD,EACCA,SACAoB,EAFD,EAECA,QACAC,EAHD,EAGCA,YAGD,OACC,+BACC,2BAAK0L,UAAU,oBACb/M,EAASgG,MAAMnF,KAAI,SAACjB,EAAMoB,GAAP,OACnB,2BACCK,YAAaA,EACbD,QAASA,EACTH,IAAKD,EACLE,MAAOtB,EACPmN,UAAS,mBANS,KAYvB,M,kFAvBmBuD,CAAkB9Q,EAAAA,W,g5FCMlBf,GAAAA,SAAAA,I,oZACnB,SAAoB4E,GAClBrE,KAAKC,MAAM8D,SAAS,CAClBnC,WAAY,CAACyC,GAAH,UAAiBrE,KAAKC,MAAM2B,eAExC5B,KAAKsE,aAAa,gBAAiBD,EACpC,G,+BAED,SAAkBA,GAChBrE,KAAKsE,aAAa,oBAAqBD,EACxC,G,+BAED,SAAkBA,GAChBrE,KAAKsE,aAAa,oBAAqBD,EACxC,G,0BAED,SAAaJ,EAAMC,GAAO,MACxBlE,KAAKC,MAAM8D,SAAS,CAClBI,MAAO,CAAEF,KAAAA,EAAMC,MAAAA,EAAOE,IAAG,UAACpE,KAAKC,MAAMkE,aAAZ,OAAC,EAAkBC,KAE/C,G,oBAED,WAAS,WACP,OACE,oBAAC4L,EAAD,CAAWtL,KAAM1E,KAAKC,MAAMyE,OACzB,SAACqI,GAAD,OACC,oBAACnE,EAAD,CACE3H,OAAQ,EAAKhB,MAAMgB,OACnBM,MAAO,EAAKtB,MAAMsB,MAClBwL,YAAaA,EACbP,oBAAqB,SAACxL,EAAUpB,GAAX,OACnB,EAAKkE,oBAAoB,CAAElE,KAAAA,EAAMoB,SAAAA,GADd,EAGrBkN,mBAAoB,SAAC7J,EAAWrC,GAAZ,OAClB,oBAACsP,GAAD,CACEtQ,SAAQ,SACHqD,EAAUrD,UADP,IAENgG,MAAO3C,EAAUrD,SAASgG,MAAMnF,KAAI,SAAAjB,GAClC,OAAO,SACFA,GADL,IAEE2Q,WAAYlN,EAAUxD,OAAS,EAAKZ,MAAMY,OAAS,UAEtD,MAEHoB,IAAKD,EACLI,QAAS,WACP,EAAK0C,kBAAkB,EAAK7E,MAAM2B,WAAWI,GAC9C,EACDK,YAAa,WACX,EAAK0C,kBAAkB,EAAK9E,MAAM2B,WAAWI,GAC9C,GAjBe,EAoBpBJ,WAAY,EAAK3B,MAAM2B,YA5B1B,GAiCN,I,qFA1DkBnC,CAAqBe,EAAAA,WA6D1Cf,GAAagB,aAAeA,EAAAA,GAC5BhB,GAAaiB,UAAYA,EAAAA,E,2tEClEJb,EAAAA,SAAAA,I,qYACjB,WACI,IAAMI,EAAQ,EAAH,KACJD,KAAKC,OADD,IAEPyE,KAAM,QAAF,OAAU1E,KAAKC,MAAMyE,KAArB,YAGR,OACI,kBAAC,UAAkBzE,EAE1B,M,gFAVgBJ,CAAsBW,EAAAA,WAc3CX,EAAcY,aAAeA,EAAAA,GAC7BZ,EAAca,UAAYA,EAAAA,E","sources":["webpack:///./src/lib/fragments/DashAnnotator.react.js","webpack:///./src/lib/fragments/HTMLAnnotator.react.js","webpack:///./src/lib/fragments/PDFHighlighter.react.js","webpack:///./src/lib/fragments/PDFLoader.react.js","webpack:///./src/lib/fragments/Highlight.react.js","webpack:///./src/lib/fragments/PDFAnnotator.react.js","webpack:///./src/lib/fragments/TextAnnotator.react.js"],"sourcesContent":["import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {defaultProps, propTypes} from '../components/DashAnnotator.react';\r\nimport PDFAnnotator from './PDFAnnotator.react';\r\nimport HTMLAnnotator from './HTMLAnnotator.react';\r\nimport TextAnnotator from './TextAnnotator.react';\r\n\r\nexport default class DashAnnotator extends Component {\r\n    _annotators = {\r\n        pdf: PDFAnnotator,\r\n        html: HTMLAnnotator,\r\n        text: TextAnnotator\r\n    }\r\n\r\n    render() {\r\n        console.log('this', this)\r\n        const { data_type: dataType, ...props } = this.props;\r\n        const Annotator = this._annotators[dataType]\r\n\r\n        if (Annotator === undefined) {\r\n            throw new Error('Invalid data_type. Valid options are: pdf, html, & text.');\r\n        }\r\n\r\n        return <Annotator {...props} />\r\n    }\r\n}\r\n\r\n\r\nDashAnnotator.defaultProps = defaultProps;\r\nDashAnnotator.propTypes = propTypes;","import {Component, createRef} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {defaultProps, propTypes} from '../components/HTMLAnnotator.react';\r\n\r\n\r\nconst findSelectButtonPosition = position => {\r\n  return position.reduce((least, item) => {\r\n    if (item.top < least.top) {\r\n      least = item;\r\n    }\r\n    return { top: least.top, left: least.left };\r\n  }, position[0]);\r\n};\r\n\r\nconst structureClientRectangle = (\r\n  clientRectangleArray,\r\n  scrollPosition\r\n) => {\r\n  return Array.from(clientRectangleArray).map(item => {\r\n    return {\r\n      left: item.left + scrollPosition.scrollX,\r\n      top: item.top + scrollPosition.scrollY,\r\n      height: item.height,\r\n      width: item.width\r\n    };\r\n  });\r\n};\r\n\r\nclass Annotation extends Component {\r\n    annotationStyle(rect, { color }, hidden=false) {\r\n        let styles = {\r\n            position: 'absolute',\r\n            height: rect.height + 2,\r\n            top: rect.top - this.props.scrollPosition.scrollY,\r\n            left: rect.left - this.props.scrollPosition.scrollX,\r\n            width: rect.width,\r\n            transform: 'translate(2px)',\r\n            backgroundColor: 'none',\r\n            opacity: 1,\r\n        }\r\n\r\n        if (hidden) {\r\n            styles = {\r\n                ...styles,\r\n                backgroundColor: color || this.props.color || 'yellow',\r\n                zIndex: -1\r\n            }\r\n        }\r\n\r\n        return styles\r\n    }\r\n\r\n    render() {\r\n        const findAnnotations = () => {\r\n        return this.props.highlights.map(singleAnnotation => {\r\n          return singleAnnotation.position.map((rectangle, index) => {\r\n            return (\r\n              <div key={index}>\r\n                <div\r\n                    style={this.annotationStyle(rectangle, singleAnnotation)}\r\n                    onClick={() => this.props.onClick(singleAnnotation)}\r\n                    onMouseOver={() => this.props.onMouseOver(singleAnnotation)}\r\n                />\r\n                <div style={this.annotationStyle(rectangle, singleAnnotation, true)} />\r\n              </div>\r\n            );\r\n          });\r\n        });\r\n      };\r\n\r\n      return <div>{findAnnotations()}</div>;\r\n    }\r\n}\r\n\r\nexport default class HTMLAnnotator extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.iframeRef = createRef();\r\n    }\r\n\r\n    state = {\r\n        newAnnotationJustCreated: false,\r\n        selection: null,\r\n        scrollPosition: {\r\n            scrollY: 0,\r\n            scrollX: 0\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.removeIframeEventHandlers()\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.removeIframeEventHandlers()\r\n    }\r\n\r\n    removeIframeEventHandlers() {\r\n        if (this.iframeRef?.current?.contentDocument) {\r\n            this.iframeRef.current.contentDocument.removeEventListener(\r\n                'scroll', this.onScroll.bind(this))\r\n            this.iframeRef.current.contentDocument.removeEventListener(\r\n                'mouseup', this.onMouseUp.bind(this))\r\n        }\r\n    }\r\n\r\n    setIframeEventHandlers() {\r\n        if (this.iframeRef?.current?.contentDocument) {\r\n            this.iframeRef.current.contentDocument.addEventListener(\r\n                'scroll', this.onScroll.bind(this))\r\n            this.iframeRef.current.contentDocument.addEventListener(\r\n                'mouseup', this.onMouseUp.bind(this))\r\n        }\r\n      }\r\n\r\n    onScroll() {\r\n        this.setState({\r\n            scrollPosition: {\r\n                scrollY: this.iframeRef.current.contentWindow.scrollY,\r\n                scrollX: this.iframeRef.current.contentWindow.scrollX\r\n            }\r\n        })\r\n    }\r\n\r\n    onMouseUp() {\r\n        const selection = this.iframeRef.current.contentWindow.getSelection();\r\n        const text = selection.toString();\r\n        if (text) {\r\n            const clientRectangleArray = selection.getRangeAt(0).getClientRects();\r\n            const position = structureClientRectangle(\r\n                clientRectangleArray,\r\n                this.state.scrollPosition\r\n            );\r\n            this.setState({\r\n                selection: { position, text },\r\n                newAnnotationJustCreated: true\r\n            })\r\n            this.onAnnotationCreated(this.state.selection)\r\n            this.props.setProps({\r\n                highlights: [\r\n                    ...this.props.highlights,\r\n                    this.state.selection\r\n                ]\r\n            })\r\n                        \r\n        }\r\n\r\n        this.setState({ selection: null })\r\n        selection.empty()\r\n    }\r\n\r\n    triggerEvent(name, value) {\r\n        this.props.setProps({\r\n            event: { name, value, _: !this.props.event?._ }\r\n        })\r\n    }\r\n\r\n    onAnnotationCreated(highlight) {\r\n        this.triggerEvent('new_highlight', highlight)\r\n    }\r\n\r\n    onAnnotationClick(highlight) {\r\n        this.triggerEvent('clicked_highlight', highlight)\r\n    }\r\n\r\n    onAnnotationHover(highlight) {\r\n        if (!this.state.newAnnotationJustCreated) {\r\n            this.triggerEvent('hovered_highlight', highlight)\r\n        } else {\r\n            this.setState({\r\n                newAnnotationJustCreated: false\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    render() {\r\n      const width = this.props.width || '100%';\r\n      const height = this.props.height || '100%';\r\n\r\n      return (\r\n        <div\r\n          onMouseLeave={() => this.setState({ selection: null })}\r\n          style={{\r\n            overflow: 'hidden',\r\n            position: 'relative',\r\n            width,\r\n            height\r\n          }}\r\n        >\r\n          <iframe\r\n            srcDoc={this.props.data}\r\n            width={width}\r\n            height={height}\r\n            ref={this.iframeRef}\r\n            onLoad={this.setIframeEventHandlers.bind(this)}\r\n          ></iframe>\r\n          {!!this.props.highlights && (\r\n            <Annotation\r\n              highlights={this.props.highlights}\r\n              color={this.props.color}\r\n              scrollPosition={this.state.scrollPosition}\r\n              onClick={this.onAnnotationClick.bind(this)}\r\n              onMouseOver={this.onAnnotationHover.bind(this)}\r\n            />\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\n\r\nHTMLAnnotator.defaultProps = defaultProps;\r\nHTMLAnnotator.propTypes = propTypes;\r\n","import { PureComponent } from 'react'\r\nimport ReactDom from 'react-dom'\r\n\r\nimport {\r\n  EventBus,\r\n  PDFViewer,\r\n  PDFLinkService,\r\n  PDFFindController\r\n} from 'pdfjs-dist/web/pdf_viewer'\r\nimport * as R from 'ramda'\r\nwindow.R = R\r\n\r\nimport 'pdfjs-dist/legacy/web/pdf_viewer.css'\r\nimport '../styles.css'\r\n\r\nconst debounce = (callback, wait) => {\r\n  let timeout\r\n  return (...args) => {\r\n    const context = this\r\n    clearTimeout(timeout)\r\n    timeout = setTimeout(() => callback.apply(context, args), wait)\r\n  }\r\n}\r\n\r\nconst getBoundingRect = clientRects => {\r\n  const rects = Array.from(clientRects).map(rect => {\r\n    const { left, top, width, height, page } = rect\r\n\r\n    const X0 = left\r\n    const X1 = left + width\r\n\r\n    const Y0 = top\r\n    const Y1 = top + height\r\n\r\n    return { X0, X1, Y0, Y1, page }\r\n  })\r\n\r\n  let firstPage = Number.MAX_SAFE_INTEGER\r\n\r\n  rects.forEach(rect => {\r\n    firstPage = Math.min(\r\n      firstPage,\r\n      rect.page ?? firstPage\r\n    )\r\n  })\r\n\r\n  const rectsWithSizeOnFirstPage = rects.filter(\r\n    rect =>\r\n      (rect.X0 > 0 || rect.X1 > 0 || rect.Y0 > 0 || rect.Y1 > 0) &&\r\n      rect.page === firstPage\r\n  )\r\n\r\n  const optimal = rectsWithSizeOnFirstPage.reduce((res, rect) => {\r\n    return {\r\n      X0: Math.min(res.X0, rect.X0),\r\n      X1: Math.max(res.X1, rect.X1),\r\n\r\n      Y0: Math.min(res.Y0, rect.Y0),\r\n      Y1: Math.max(res.Y1, rect.Y1),\r\n\r\n      page: firstPage\r\n    }\r\n  }, rectsWithSizeOnFirstPage[0])\r\n\r\n  const { X0, X1, Y0, Y1, page } = optimal\r\n\r\n  return {\r\n    left: X0,\r\n    top: Y0,\r\n    width: X1 - X0,\r\n    height: Y1 - Y0,\r\n    page\r\n  }\r\n}\r\n\r\nconst isClientRectInsidePageRect = (clientRect, pageRect) =>\r\n  clientRect.top >= pageRect.top &&\r\n  clientRect.bottom <= pageRect.bottom &&\r\n  clientRect.right <= pageRect.right &&\r\n  clientRect.left >= pageRect.left\r\n\r\nconst overlaps = (A, B) =>\r\n  A.page === B.page &&\r\n  A.left <= B.left &&\r\n  B.left <= A.left + A.width\r\n\r\nconst sameLine = (A, B, yMargin = 5) =>\r\n  A.page === B.page &&\r\n  Math.abs(A.top - B.top) < yMargin &&\r\n  Math.abs(A.height - B.height) < yMargin\r\n\r\nconst inside = (A, B) =>\r\n  A.page === B.page &&\r\n  A.top > B.top &&\r\n  A.left > B.left &&\r\n  A.top + A.height < B.top + B.height &&\r\n  A.left + A.width < B.left + B.width\r\n\r\nconst nextTo = (A, B, xMargin = 10) => {\r\n  const Aright = A.left + A.width\r\n  const Bright = B.left + B.width\r\n\r\n  return (\r\n    A.page === B.page &&\r\n    A.left <= B.left &&\r\n    Aright <= Bright &&\r\n    B.left - Aright <= xMargin\r\n  )\r\n}\r\n\r\nconst extendWidth = (A, B) => {\r\n  A.width = Math.max(B.width - A.left + B.left, A.width)\r\n}\r\n\r\nconst optimizeClientRects = clientRects => {\r\n  const rects = clientRects.sort((A, B) => {\r\n    const top = (A.page || 0) * A.top - (B.page || 0) * B.top\r\n    return top === 0 ? A.left - B.left : top\r\n  })\r\n\r\n  const toRemove = new Set()\r\n\r\n  const firstPass = rects.filter(rect => {\r\n    return rects.every(otherRect => {\r\n      return !inside(rect, otherRect)\r\n    })\r\n  })\r\n\r\n  let passCount = 0\r\n\r\n  while (passCount <= 2) {\r\n    firstPass.forEach(A => {\r\n      firstPass.forEach(B => {\r\n        if (A === B || toRemove.has(A) || toRemove.has(B)) {\r\n          return\r\n        }\r\n\r\n        if (!sameLine(A, B)) {\r\n          return\r\n        }\r\n\r\n        if (overlaps(A, B)) {\r\n          extendWidth(A, B)\r\n          A.height = Math.max(A.height, B.height)\r\n\r\n          toRemove.add(B)\r\n        }\r\n\r\n        if (nextTo(A, B)) {\r\n          extendWidth(A, B)\r\n\r\n          toRemove.add(B)\r\n        }\r\n      })\r\n    })\r\n    passCount += 1\r\n  }\r\n\r\n  return firstPass.filter(rect => !toRemove.has(rect))\r\n}\r\n\r\nconst getClientRects = (range, pages, shouldOptimize = true) => {\r\n  const clientRects = Array.from(range.getClientRects())\r\n\r\n  const rects = []\r\n\r\n  for (const clientRect of clientRects) {\r\n    for (const page of pages) {\r\n      const pageRect = page.node.getBoundingClientRect()\r\n\r\n      if (\r\n        isClientRectInsidePageRect(clientRect, pageRect) &&\r\n        clientRect.top >= 0 &&\r\n        clientRect.bottom >= 0 &&\r\n        clientRect.width > 0 &&\r\n        clientRect.height > 0 &&\r\n        clientRect.width < pageRect.width &&\r\n        clientRect.height < pageRect.height\r\n      ) {\r\n        const highlightedRect = {\r\n          top: clientRect.top + page.node.scrollTop - pageRect.top,\r\n          left: clientRect.left + page.node.scrollLeft - pageRect.left,\r\n          width: clientRect.width,\r\n          height: clientRect.height,\r\n          page: page.number\r\n        }\r\n\r\n        rects.push(highlightedRect)\r\n      }\r\n    }\r\n  }\r\n\r\n  return shouldOptimize ? optimizeClientRects(rects) : rects\r\n}\r\n\r\nconst getDocument = e => (e || {}).ownerDocument || document\r\nconst getWindow = e => (getDocument(e) || {}).defaultView || window\r\nconst isHTMLElement = e =>\r\n  e instanceof HTMLElement || e instanceof getWindow(e).HTMLElement\r\n\r\nconst getPageFromElement = target => {\r\n  const node = target.closest('.page')\r\n\r\n  if (!node || !isHTMLElement(node)) {\r\n    return null\r\n  }\r\n\r\n  const number = Number(node.dataset.pageNumber)\r\n\r\n  return { node, number }\r\n}\r\n\r\nconst getPagesFromRange = range => {\r\n  const startParentElement = range?.startContainer?.parentElement\r\n  const endParentElement = range?.endContainer?.parentElement\r\n\r\n  if (!isHTMLElement(startParentElement) || !isHTMLElement(endParentElement)) {\r\n    return []\r\n  }\r\n\r\n  const startPage = getPageFromElement(startParentElement)\r\n  const endPage = getPageFromElement(endParentElement)\r\n\r\n  if (!startPage?.number || !endPage?.number) {\r\n    return []\r\n  }\r\n\r\n  if (startPage.number === endPage.number) {\r\n    return [startPage]\r\n  }\r\n\r\n  if (startPage.number === endPage.number - 1) {\r\n    return [startPage, endPage]\r\n  }\r\n\r\n  const pages = []\r\n\r\n  let currentPage = startPage.number\r\n\r\n  const document = startPage.node.ownerDocument\r\n\r\n  while (currentPage <= endPage.number) {\r\n    const currentPage = getPageFromElement(\r\n      document.querySelector(`[data-page-number='${currentPage}'`)\r\n    )\r\n    if (currentPage) {\r\n      pages.push(currentPage)\r\n    }\r\n  }\r\n\r\n  return pages\r\n}\r\n\r\nexport default class PDFHighlighter extends PureComponent {\r\n  static defaultProps = {\r\n    pdfScaleValue: 'auto'\r\n  }\r\n\r\n  state = {\r\n    isCollapsed: true,\r\n    range: null\r\n  }\r\n\r\n  eventBus = new EventBus()\r\n  linkService = new PDFLinkService({\r\n    eventBus: this.eventBus,\r\n    externalLinkTarget: 2\r\n  })\r\n\r\n  resizeObserver = null\r\n  containerNode = null\r\n  unsubscribe = () => {}\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    if (typeof ResizeObserver !== 'undefined') {\r\n      this.resizeObserver = new ResizeObserver(this.debouncedScaleValue)\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.init()\r\n  }\r\n\r\n  attachRef = ref => {\r\n    const { eventBus, resizeObserver: observer } = this\r\n    this.containerNode = ref\r\n    this.unsubscribe()\r\n\r\n    if (ref) {\r\n      const { ownerDocument: doc } = ref\r\n      eventBus.on('textlayerrendered', this.onTextLayerRendered)\r\n      eventBus.on('pagesinit', this.onDocumentReady)\r\n      doc.addEventListener('selectionchange', this.onSelectionChange)\r\n      doc.addEventListener('keydown', this.handleKeyDown)\r\n      doc.defaultView?.addEventListener('resize', this.debouncedScaleValue)\r\n      if (observer) observer.observe(ref)\r\n\r\n      this.unsubscribe = () => {\r\n        eventBus.off('pagesinit', this.onDocumentReady)\r\n        eventBus.off('textlayerrendered', this.onTextLayerRendered)\r\n        doc.removeEventListener('selectionchange', this.onSelectionChange)\r\n        doc.removeEventListener('keydown', this.handleKeyDown)\r\n        doc.defaultView?.removeEventListener('resize', this.debouncedScaleValue)\r\n        if (observer) observer.disconnect()\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.pdfDocument !== this.props.pdfDocument) {\r\n      this.init()\r\n    } else if (prevProps.highlights !== this.props.highlights) {\r\n      this.renderHighlights(this.props)\r\n    }\r\n  }\r\n\r\n  init() {\r\n    const { pdfDocument } = this.props\r\n\r\n    this.findController = \r\n      this.findController ||\r\n      new PDFFindController({\r\n        linkService: this.linkService,\r\n        eventBus: this.eventBus\r\n      })\r\n\r\n    this.viewer =\r\n      this.viewer ||\r\n      new PDFViewer({\r\n        container: this.containerNode,\r\n        eventBus: this.eventBus,\r\n        findController: this.findController,\r\n        textLayerMode: 2,\r\n        removePageBorders: true,\r\n        linkService: this.linkService,\r\n        renderer: 'canvas',\r\n        l10n: null\r\n      })\r\n\r\n    this.linkService.setDocument(pdfDocument)\r\n    this.linkService.setViewer(this.viewer)\r\n    this.viewer.setDocument(pdfDocument)\r\n\r\n    console.log('highligher', this)\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.unsubscribe()\r\n  }\r\n\r\n  findOrCreateHighlightLayer(page) {\r\n    const { textLayer } = this.viewer.getPageView(page - 1) || {}\r\n\r\n    if (!textLayer) {\r\n      return null\r\n    }\r\n\r\n    let containerLayer = textLayer.textLayerDiv.querySelector(\r\n      '.PdfHighlighter__highlight-layer'\r\n    )\r\n\r\n    if (!containerLayer) {\r\n      containerLayer = getDocument(textLayer.textLayerDiv).createElement('div')\r\n      containerLayer.className = '.PdfHighlighter__highlight-layer'\r\n      textLayer.textLayerDiv.appendChild(containerLayer)\r\n    }\r\n\r\n    return containerLayer\r\n  }\r\n\r\n  renderHighlights(nextProps) {\r\n    const { highlightTransform, highlights } = nextProps || this.props\r\n\r\n    const { pdfDocument } = this.props\r\n\r\n    const highlightsByPage = R.groupBy(\r\n      R.path(['position', 'page']),\r\n      R.filter(Boolean, highlights)\r\n    )\r\n\r\n    for (let page = 1; page <= pdfDocument.numPages; page++) {\r\n      const highlightLayer = this.findOrCreateHighlightLayer(page)\r\n\r\n      if (highlightLayer) {\r\n        ReactDom.render(\r\n          <div>\r\n            {(highlightsByPage[String(page)] || []).map(\r\n              ({ position, id, ...highlight }, index) => {\r\n                return highlightTransform(\r\n                  {\r\n                    id,\r\n                    position: position,\r\n                    ...highlight\r\n                  },\r\n                  index\r\n                )\r\n              }\r\n            )}\r\n          </div>,\r\n          highlightLayer\r\n        )\r\n      }\r\n    }\r\n  }\r\n\r\n  onTextLayerRendered = () => {\r\n    this.renderHighlights()\r\n  }\r\n\r\n  onDocumentReady = () => {\r\n    this.handleScaleValue()\r\n  }\r\n\r\n  onSelectionChange = () => {\r\n    const container = this.containerNode\r\n    const selection = getWindow(container).getSelection()\r\n\r\n    if (!selection) {\r\n      return\r\n    }\r\n\r\n    const range = selection.rangeCount > 0 ? selection.getRangeAt(0) : null\r\n\r\n    if (selection.isCollapsed) {\r\n      this.setState({ isCollapsed: true })\r\n      return\r\n    }\r\n\r\n    if (\r\n      !range ||\r\n      !container ||\r\n      !container.contains(range.commonAncestorContainer)\r\n    ) {\r\n      return\r\n    }\r\n\r\n    this.setState({\r\n      isCollapsed: false,\r\n      range\r\n    })\r\n\r\n    this.debouncedAfterSelection()\r\n  }\r\n\r\n  onScroll = () => {\r\n    this.renderHighlights()\r\n\r\n    this.viewer.container.removeEventListener('scroll', this.onScroll)\r\n  }\r\n\r\n  onMouseDown = event => {\r\n    if (!isHTMLElement(event.target)) {\r\n      return\r\n    }\r\n  }\r\n\r\n  afterSelection = () => {\r\n    const { isCollapsed, range } = this.state\r\n    const pages = getPagesFromRange(range)\r\n    const rects = getClientRects(range, pages)\r\n\r\n    if (\r\n      !range ||\r\n      isCollapsed ||\r\n      !pages ||\r\n      pages.length == 0 ||\r\n      rects.length === 0\r\n    )\r\n      return\r\n\r\n    const boundingRect = getBoundingRect(rects)\r\n\r\n    this.props.onSelectionFinished(\r\n      {\r\n        page: pages[0].number,\r\n        boundingRect,\r\n        rects\r\n      },\r\n      range.toString()\r\n    )\r\n  }\r\n\r\n  debouncedAfterSelection = debounce(this.afterSelection, 500)\r\n\r\n  handleScaleValue = () => {\r\n    if (this.viewer) {\r\n      this.viewer.currentScaleValue = this.props.pdfScaleValue\r\n    }\r\n  }\r\n\r\n  debouncedScaleValue = debounce(this.handleScaleValue, 500)\r\n\r\n  render() {\r\n    return (\r\n      <div onPointerDown={this.onMouseDown}>\r\n        <div\r\n          ref={this.attachRef}\r\n          className=\"PdfHighlighter\"\r\n          onContextMenu={e => e.preventDefault()}\r\n          style={{\r\n            height: this.props.height,\r\n            width: this.props.width\r\n          }}\r\n        >\r\n          <div className=\"pdfViewer\" />\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { getDocument, GlobalWorkerOptions } from 'pdfjs-dist/build/pdf'\r\n\r\n\r\nvar BASE64_MARKER = ';base64,';\r\n\r\nfunction convertDataURIToBinary(dataURI) {\r\n  var base64Index = dataURI.indexOf(BASE64_MARKER) + BASE64_MARKER.length;\r\n  var base64 = dataURI.substring(base64Index);\r\n  var raw = window.atob(base64);\r\n  var rawLength = raw.length;\r\n  var array = new Uint8Array(new ArrayBuffer(rawLength));\r\n\r\n  for(var i = 0; i < rawLength; i++) {\r\n    array[i] = raw.charCodeAt(i);\r\n  }\r\n  return array;\r\n}\r\n\r\n\r\nexport default class PDFLoader extends Component {\r\n  state = {\r\n    pdfDocument: null,\r\n    error: null\r\n  }\r\n\r\n  static defaultProps = {\r\n    workerSrc: 'https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.worker.min.js'\r\n  }\r\n\r\n  documentRef = React.createRef()\r\n\r\n  componentDidMount() {\r\n    this.load()\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    const { pdfDocument: discardedDocument } = this.state\r\n    if (discardedDocument) {\r\n      discardedDocument.destroy()\r\n    }\r\n  }\r\n\r\n  componentDidUpdate({ data }) {\r\n    if (this.props.data !== data) {\r\n      this.load()\r\n    }\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    const { onError } = this.props\r\n\r\n    if (onError) {\r\n      onError(error)\r\n    }\r\n\r\n    this.setState({ pdfDocument: null, error })\r\n  }\r\n\r\n  load() {\r\n    const { ownerDocument = document } = this.documentRef.current || {}\r\n    const { data, cMapUrl, cMapPacked, workerSrc } = this.props\r\n    const { pdfDocument: discardedDocument } = this.state\r\n    this.setState({ pdfDocument: null, error: null })\r\n\r\n    if (typeof workerSrc === 'string') {\r\n      GlobalWorkerOptions.workerSrc = workerSrc\r\n    }\r\n\r\n    Promise.resolve()\r\n      .then(() => discardedDocument && discardedDocument.destroy())\r\n      .then(() => {\r\n        if (!data) {\r\n          return\r\n        }\r\n\r\n        return getDocument({\r\n          ...this.props,\r\n          data: convertDataURIToBinary(data),\r\n          workerSrc: 'https://unpkg.com/pdfjs-dist@2.11.338/build/pdf.worker.min.js',\r\n          ownerDocument,\r\n          cMapUrl,\r\n          cMapPacked\r\n        }).promise.then(pdfDocument => {\r\n          this.setState({ pdfDocument })\r\n        })\r\n      })\r\n      .catch(e => this.componentDidCatch(e))\r\n  }\r\n\r\n  render() {\r\n    const { children, beforeLoad } = this.props\r\n    const { pdfDocument, error } = this.state\r\n    return (\r\n      <>\r\n        <span ref={this.documentRef} />\r\n        {error\r\n          ? this.renderError()\r\n          : !pdfDocument || !children\r\n          ? beforeLoad\r\n          : children(pdfDocument)}\r\n      </>\r\n    )\r\n  }\r\n\r\n  renderError() {\r\n    const { errorMessage } = this.props\r\n    if (errorMessage) {\r\n      return React.cloneElement(errorMessage, { error: this.state.error })\r\n    }\r\n\r\n    return null\r\n  }\r\n}\r\n","import { Component } from 'react'\r\n\r\n\r\nexport default class Highlight extends Component {\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tposition,\r\n\t\t\tonClick,\r\n\t\t\tonMouseOver,\r\n\t\t} = this.props\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div className=\"Highlight__parts\">\r\n\t\t\t\t\t{position.rects.map((rect, index) => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tonMouseOver={onMouseOver}\r\n\t\t\t\t\t\t\tonClick={onClick}\r\n\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\tstyle={rect}\r\n\t\t\t\t\t\t\tclassName={`Highlight__part`}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n","import { Component, createRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { defaultProps, propTypes } from '../components/PDFAnnotator.react';\r\n\r\nimport PDFHighlighter from './PDFHighlighter.react';\r\nimport PDFLoader from './PDFLoader.react';\r\nimport Highlight from './Highlight.react';\r\n\r\n\r\nexport default class PDFAnnotator extends Component {\r\n  onAnnotationCreated(highlight) {\r\n    this.props.setProps({\r\n      highlights: [highlight, ...this.props.highlights]\r\n    })\r\n    this.triggerEvent('new_highlight', highlight)\r\n  }\r\n\r\n  onAnnotationClick(highlight) {\r\n    this.triggerEvent('clicked_highlight', highlight)\r\n  }\r\n\r\n  onAnnotationHover(highlight) {\r\n    this.triggerEvent('hovered_highlight', highlight)\r\n  }\r\n\r\n  triggerEvent(name, value) {\r\n    this.props.setProps({\r\n      event: { name, value, _: !this.props.event?._ }\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <PDFLoader data={this.props.data}>\r\n        {(pdfDocument) => (\r\n          <PDFHighlighter\r\n            height={this.props.height}\r\n            width={this.props.width}\r\n            pdfDocument={pdfDocument}\r\n            onSelectionFinished={(position, text) => (\r\n              this.onAnnotationCreated({ text, position })\r\n            )}\r\n            highlightTransform={(highlight, index) => (\r\n              <Highlight\r\n                position={{\r\n                  ...highlight.position,\r\n                  rects: highlight.position.rects.map(rect => {\r\n                    return {\r\n                      ...rect,\r\n                      background: highlight.color || this.props.color || 'yellow'\r\n                    }\r\n                  })\r\n                }}\r\n                key={index}\r\n                onClick={() => {\r\n                  this.onAnnotationClick(this.props.highlights[index]);\r\n                }}\r\n                onMouseOver={() => {\r\n                  this.onAnnotationHover(this.props.highlights[index]);\r\n                }}\r\n              />\r\n            )}\r\n            highlights={this.props.highlights}\r\n          />\r\n        )}\r\n      </PDFLoader>\r\n    );\r\n  }\r\n}\r\n\r\nPDFAnnotator.defaultProps = defaultProps;\r\nPDFAnnotator.propTypes = propTypes;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {defaultProps, propTypes} from '../components/TextAnnotator.react';\r\nimport HTMLAnnotator from './HTMLAnnotator.react';\r\n\r\nexport default class TextAnnotator extends Component {\r\n    render() {\r\n        const props = {\r\n            ...this.props,\r\n            data: `<pre>${this.props.data}</pre>`\r\n        }\r\n\r\n        return (\r\n            <HTMLAnnotator {...props} />\r\n        );\r\n    }\r\n}\r\n\r\n\r\nTextAnnotator.defaultProps = defaultProps;\r\nTextAnnotator.propTypes = propTypes;"],"names":["DashAnnotator","pdf","PDFAnnotator","html","HTMLAnnotator","text","TextAnnotator","console","log","this","props","dataType","data_type","Annotator","_annotators","undefined","Error","Component","defaultProps","propTypes","Annotation","rect","color","hidden","styles","position","height","top","scrollPosition","scrollY","left","scrollX","width","transform","backgroundColor","opacity","zIndex","highlights","map","singleAnnotation","rectangle","index","key","style","annotationStyle","onClick","onMouseOver","newAnnotationJustCreated","selection","iframeRef","createRef","removeIframeEventHandlers","current","contentDocument","removeEventListener","onScroll","bind","onMouseUp","addEventListener","setState","contentWindow","getSelection","toString","clientRectangleArray","Array","from","item","structureClientRectangle","getRangeAt","getClientRects","state","onAnnotationCreated","setProps","empty","name","value","event","_","highlight","triggerEvent","onMouseLeave","overflow","srcDoc","data","ref","onLoad","setIframeEventHandlers","onAnnotationClick","onAnnotationHover","window","R","debounce","callback","wait","timeout","args","context","clearTimeout","setTimeout","apply","isClientRectInsidePageRect","clientRect","pageRect","bottom","right","overlaps","A","B","page","sameLine","yMargin","Math","abs","nextTo","xMargin","Aright","Bright","extendWidth","max","optimizeClientRects","clientRects","rects","sort","toRemove","Set","firstPass","filter","every","otherRect","passCount","forEach","has","add","getDocument","e","ownerDocument","document","getWindow","defaultView","isHTMLElement","HTMLElement","getPageFromElement","target","node","closest","number","Number","dataset","pageNumber","PDFHighlighter","isCollapsed","range","EventBus","PDFLinkService","eventBus","externalLinkTarget","observer","resizeObserver","containerNode","unsubscribe","doc","on","onTextLayerRendered","onDocumentReady","onSelectionChange","handleKeyDown","debouncedScaleValue","observe","off","disconnect","renderHighlights","handleScaleValue","container","rangeCount","contains","commonAncestorContainer","debouncedAfterSelection","viewer","pages","startParentElement","startContainer","parentElement","endParentElement","endContainer","startPage","endPage","currentPage","querySelector","push","getPagesFromRange","shouldOptimize","getBoundingClientRect","highlightedRect","scrollTop","scrollLeft","length","boundingRect","X0","X1","Y0","Y1","firstPage","MAX_SAFE_INTEGER","min","rectsWithSizeOnFirstPage","optimal","reduce","res","getBoundingRect","onSelectionFinished","afterSelection","currentScaleValue","pdfScaleValue","ResizeObserver","init","prevProps","pdfDocument","findController","PDFFindController","linkService","PDFViewer","textLayerMode","removePageBorders","renderer","l10n","setDocument","setViewer","textLayer","getPageView","containerLayer","textLayerDiv","createElement","className","appendChild","nextProps","highlightTransform","highlightsByPage","Boolean","numPages","highlightLayer","findOrCreateHighlightLayer","ReactDom","String","id","onPointerDown","onMouseDown","attachRef","onContextMenu","preventDefault","PureComponent","BASE64_MARKER","convertDataURIToBinary","dataURI","base64Index","indexOf","base64","substring","raw","atob","rawLength","array","Uint8Array","ArrayBuffer","i","charCodeAt","PDFLoader","error","React","load","discardedDocument","destroy","info","onError","documentRef","cMapUrl","cMapPacked","workerSrc","GlobalWorkerOptions","Promise","resolve","then","promise","componentDidCatch","children","beforeLoad","renderError","errorMessage","Highlight","background"],"sourceRoot":""}